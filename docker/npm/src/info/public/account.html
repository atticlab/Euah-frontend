<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">
	<title>Ledger Viewer</title>
	<link href="/template/css/bootstrap.min.css" rel="stylesheet" type="text/css">
	<link href="/template/css/info.css" rel="stylesheet" type="text/css">
	<link href="/template/plugins/chartist/dist/chartist.min.css" rel="stylesheet" type="text/css">
	<link href="/template/css/core.css" rel="stylesheet" type="text/css">
	<link href="/template/css/icons.css" rel="stylesheet" type="text/css">
	<link href="/template/css/components.css" rel="stylesheet" type="text/css">
	<link href="/template/css/pages.css" rel="stylesheet" type="text/css">
	<link href="/template/css/menu.css" rel="stylesheet" type="text/css">
	<link href="/template/css/responsive.css" rel="stylesheet" type="text/css">
	<link href="/template/css/custom.css" rel="stylesheet" type="text/css">

	<!-- jQuery  -->
	<script src="/template/js/jquery.min.js"></script>
	<script src="/template/js/bootstrap.min.js"></script>
	<script src="/js/config.js"></script>

	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function()
				{ (i[r].q=i[r].q||[]).push(arguments)}
				,i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-84353701-2', 'auto');
		ga('send', 'pageview');
	</script>
	<!-- Google Analytics FINISH -->
</head>
<body>

	<!-- Navigation Bar-->
	<header id="topnav">

		<script type="text/template" id="tpl-header">
			<div class="topbar-main">
				<div class="container">
					<div class="logo">
						<a href="/" class="logo">
							<img src="/template/images/logo/<%= logo_src %>" alt=""/>
							<span><%=locale.ledger_viewer%></span>
						</a>
					</div>
					<ul class="nav navbar-nav navbar-right pull-right">
						<div class="menu-extras">
							<div class="text-right flags">
								<a href="?lang=ua">
									<img src="/template/images/ua.png" alt="UA"/>
								</a>
								<a href="?lang=en">
									<img src="/template/images/uk.png" alt="EN"/>
								</a>
							</div>
						</div>

					</ul>
				</div>
			</div>
		</script>

	</header>

	<div class="wrapper">
		<div class="container" id="global">

			<script type="text/template" id="tpl-global">

                <div class="row">
                    <div class="col-sm-12 col-lg-6">
                        <div class="widget-simple text-center card-box">
                            <h3 class="text-primary"><span class="counter" id="total_sum_plus">0</span> ₴</h3>
                            <p class="text-muted"><%=locale.last_plus_txs_amount%></p>
                        </div>
                    </div>
                    <div class="col-sm-12 col-lg-6">
                        <div class="widget-simple text-center card-box">
                            <h3 class="text-danger"><span class="counter" id="total_sum_minus">0</span> ₴</h3>
                            <p class="text-muted"><%=locale.last_minus_txs_amount%></p>
                        </div>
                    </div>
                </div>

				<div class="row">
					<div class="col-lg-12">
						<div class="panel panel-default panel-color">
							<div class="panel-heading">
								<h3 class="panel-title"><%=locale.acc_info%></h3>
							</div>
							<div class="panel-body" id="acc_balance">
							</div>
						</div>
					</div>
				</div>

				<div class="row">
					<div class="col-lg-12 hidden-xs">
						<div class="card-box">
							<h4 class="m-t-0 header-title"><b><%=locale.last_txs%></b></h4>
							<div id="smil-left-animations" class="ct-chart ct-golden-section"></div>
						</div>
					</div>
				</div>
				<!-- end row -->

				<div class="card-box hidden-xs">
					<h4 class="m-t-0 header-title"><%=locale.payments%></h4>
					<table class="table table-striped m-0">
						<thead>
						<tr>
							<th><%=locale.id_tx%></th>
							<th><%=locale.payment_from%></th>
							<th><%=locale.payment_to%></th>
							<th><%=locale.amount%></th>
						</tr>
						</thead>
						<tbody id="tx-table"></tbody>
					</table>
				</div>

				<div class="payments visible-xs">
					<div id="mobile-div"></div>
				</div>
			</script>

		</div>

		<script type="text/template" id="acc_balance_data">
			<% switch(account.type_i) { case 3: case 4: case 5: %>
			<div class="alert alert-danger">
				<strong><%=locale.attention%>!</strong> <%=locale.will_hidden%>
			</div>
			<% } %>
			<p class="acc_overflow"><%=locale.account%>: <%=account.account_id %></p>
			<p><%=locale.acc_type%>:
				<% switch(account.type_i) { case 0: %>
				<%=locale.acc_type_anonymous %>
				<% break; case 1: %>
				<%=locale.acc_type_registered %>
				<% break; case 2: %>
				<%=locale.acc_type_merchant %>
				<% break; case 3: %>
				<%=locale.acc_type_distribution %>
				<% break; case 4: %>
				<%=locale.acc_type_settlement %>
				<% break; case 5: %>
				<%=locale.acc_type_exchange %>
				<% break; case 6: %>
				<%=locale.acc_type_bank %>
				<% break; } %>
			</p>
			<p><%=locale.acc_balances%>:
				<% account.balances.map(function(b){ %>
				<% if (b.asset_type != 'native') { %>
				<span class="label label-success"><%=parseFloat(b.balance).toFixed(2)%> <%=b.asset_code%></span>&nbsp;&nbsp;&nbsp;
				<% } %>
				<% }) %>
			</p>
		</script>

		<script type="text/template" id="tpl-tx-table-tr">
			<tr class="bg-success">
				<td><a href="/transaction?tx=<%= payment._links.transaction.href.split(/[\/ ]+/).pop()%>"><%=payment.id%></a></td>
				<td title="<%=payment.from%>">
					<% if(payment.from == cur_acc) { %>
					<%=_.trunc(payment.from, {length: 15})%>
					<% } else { %>
					<a href="/account?acc=<%=payment.from%>"><%=_.trunc(payment.from, {length: 15})%></a>
					<% } %>
				</td>
				<td title="<%=payment.to%>">
					<% if(payment.to == cur_acc) { %>
					<%=_.trunc(payment.to, {length: 15})%>
					<% } else { %>
					<a href="/account?acc=<%=payment.to%>"><%=_.trunc(payment.to, {length: 15})%></a>
					<% } %>
				</td>
                <td><div class="label label-success">
					<span class="amounts" data-plus="<%= payment.to == cur_acc%>">
						<%=parseFloat(payment.amount).toFixed(2)%>
					</span>
					<% if(payment.fee.type_i > 0){%>
					[<%=parseFloat(payment.amount-payment.fee.amount_changed).toFixed(2)%> + <%=parseFloat(payment.fee.amount_changed).toFixed(2)%>]
					<%}%>
					<%=payment.asset_code%></div></td>
			</tr>
		</script>

		<script type="text/template" id="tpl-mobile-div">
			<div class="payment">
				<p><span><%=locale.payment_from%>: </span><a href="/account?acc=<%=payment.from%>"><%=_.trunc(payment.from, {length: 15})%></a></p>
				<p><span><%=locale.payment_to%>: </span><a href="/account?acc=<%=payment.to%>"><%=_.trunc(payment.to, {length: 15})%></a></p>
				<hr>
				<div class="row">
					<div class="col-xs-7">
						<span><%=locale.id_tx%>: </span><a href="/transaction?tx=<%= payment._links.transaction.href.split(/[\/ ]+/).pop()%>"><%=payment.id%></a>
					</div>
					<div class="col-xs-5 text-right">
                            <span class="label label-success">
                                <i class="fa fa-sign-in fa-fw"
								   aria-hidden="true"></i>
                                &nbsp;
                                <%=parseFloat(payment.amount).toFixed(2)%>
								<% if(payment.fee.type_i > 0){%>
									[<%=parseFloat(payment.amount-payment.fee.amount_changed).toFixed(2)%> + <%=parseFloat(payment.fee.amount_changed).toFixed(2)%>]
								<%}%>
								<%=payment.asset_code%>
                            </span>
					</div>
					<div class="clearfix"></div>
				</div>
			</div>
		</script>

		<script>
			document.addEventListener("DOMContentLoaded", function(event) {

				if (typeof window.get_params.acc != 'undefined' && window.get_params.acc.length) {
					getAccountInfo(window.get_params.acc);
					accountPaymentsInfo(window.get_params.acc);
				} else {
					window.location.href = '/';
				}

			});
		</script>

	</div>

	<script src="/node_modules/sjcl/sjcl.js"></script>
	<script src="/node_modules/stellar-sdk/dist/stellar-sdk.min.js"></script>

	<!-- Notification js -->
	<script src="/template/plugins/notifyjs/dist/notify.min.js"></script>
	<script src="/template/plugins/notifications/notify-metro.js"></script>

	<!-- Chartist -->
	<script src="/template/plugins/chartist/dist/chartist.min.js"></script>

    <!-- Counter Up  -->
    <script src="/template/plugins/waypoints/lib/jquery.waypoints.js"></script>
    <script src="/template/plugins/counterup/jquery.counterup.min.js"></script>

	<!-- Custom main Js -->
	<script src="/template/js/jquery.core.js"></script>
	<script src="/template/js/locales.js"></script>
	<script src="./build/bundle.js"></script>
	<script src="/template/js/info.js"></script>

</body>
</html>